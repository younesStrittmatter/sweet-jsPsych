<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>jsPsych RSVP Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- jsPsych core (global initJsPsych, jsPsych*) -->
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <!-- one stock plugin for the welcome screen -->
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
    <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css"/>

    <style>
        html, body {
            margin: 0;
            height: 100%;
            background: #111;
        }

        .note {
            position: fixed;
            left: 12px;
            bottom: 12px;
            color: #bbb;
            font: 12px/1.3 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        }
    </style>
</head>
<body>
<!-- Your RSVP plugin IIFE (exposes window.jsPsychRsvp and also supports "rsvp" via shim) -->
<script src="../dist/index.browser.min.js"></script>

<script>
    const jsPsych = initJsPsych({});

    const welcome = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: "<p><b>RSVP demo</b><br>Press any key to start.</p>"
    };

    // --- 1) Single-stream (center-ish) with target decoration ---
    // Use one stream; default layout is row (left-right) but with one stream it's centered.
    // Press 'J' when you see "D". Target is circled in red; distractors are not decorated.
    // const trial_single_stream = {
    //   type: jsPsychRsvp,                // or: type: "rsvp"
    //   background: "#000",               // explicit (default is black)
    //   color: "#fff",                    // explicit (default is white)
    //   direction: "row",                 // default; left-right alignment
    //   gap: "3rem",
    //   streams: [{ id: "center", items: ["A","B","C","D","E","F"] }],
    //   stimulus_duration: 100,
    //   isi: 50,
    //   mask_html: "•",
    //   choices: ["j"],
    //   targets: [{ stream_id: "center", index: 3, label: "T1", correct_keys: ["j"], response_window: 700 }],
    //   // decorate only targets (red circle)
    //   decorate_targets: true,
    //   target_shape: "circle",
    //   target_color: "#ff5252",
    //   target_stroke: "3px",
    //   // no distractor decoration here
    //   decorate_distractors: false
    // };

    // --- 2) Bilateral (left-right) with target & distractor decorations ---
    // Press F for left-Q and J for right-Q. Targets get red circle; all other positions are grey underlined.
    const trial_bilateral = {
        type: jsPsychRsvp,
        streams: [
            {id: "left", items: ["O", "O", "Q", "O", "O", "O"]},
            {id: "right", items: ["O", "O", "O", "O", "Q", "O"]},
        ],
        // stream_order: "left,right",       // ensure left then right in DOM
        stimulus_duration: 200,
        isi: 40,
        targets: [
            {stream_id: "left", index: 2, shape: "circle"},
            {stream_id: "right", index: 4, shape: "square"},
        ],


    };

    // --- 3) Vertical (top-bottom) with explicit distractors & square decoration ---
    // Same keys as above, but streams stacked vertically. Targets get blue squares; explicit distractors have grey squares.
    // const trial_vertical = {
    //   type: jsPsychRsvp,
    //   background: "#000",
    //   color: "#fff",
    //   direction: "column",              // top-bottom layout
    //   gap: "3rem",
    //   streams: [
    //     { id: "top",    items: ["X","X","T","X","X","X"] },
    //     { id: "bottom", items: ["X","X","X","X","T","X"] },
    //   ],
    //   // explicit DOM order (top then bottom)
    //   stream_order: "top,bottom",
    //   stimulus_duration: 120,
    //   isi: 20,
    //   mask_html: "",
    //   choices: ["f","j"],
    //   correct_keys: "f,j",
    //   targets: [
    //     { stream_id: "top",    index: 2, label: "topT",    correct_keys: ["f"], response_window: null },  // no time limit for this one
    //     { stream_id: "bottom", index: 4, label: "bottomT", correct_keys: ["j"], response_window: 800 },
    //   ],
    //   // decorations: targets blue squares
    //   decorate_targets: true,
    //   target_shape: "square",
    //   target_color: "#4da3ff",
    //   target_stroke: "3px",
    //   token_padding: "0.25em 0.45em",
    //   // explicit distractors (show all others as grey squares)
    //   decorate_distractors: true,
    //   distractor_shape: "square",
    //   distractor_color: "#888",
    //   distractor_stroke: "2px",
    //   // If you want to explicitly mark distractors instead of "all non-targets", list them here:
    //   // distractors: [{ stream_id: "top", index: 0 }, ...]
    // };

    jsPsych.run([welcome, trial_bilateral]);
</script>

<div class="note">
    Demo keys: trial 1 → J on D; trial 2 → F for left Q, J for right Q; trial 3 → F for top T, J for bottom T.
</div>
</body>
</html>
