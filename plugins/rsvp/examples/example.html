<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>jsPsych RSVP Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <!-- jsPsych core -->
  <script src="https://unpkg.com/jspsych@7.3.4"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
  <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css"/>

  <style>
    html, body { margin: 0; height: 100%; background: #111; }
    .note {
      position: fixed; left: 12px; bottom: 12px; color: #bbb;
      font: 12px/1.3 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
  </style>
</head>
<body>
  <!-- Your bundle from the TS file above -->
  <script src="../dist/index.browser.min.js"></script>

  <script>
    const jsPsych = initJsPsych({});

    const welcome = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: "<p><b>RSVP demos</b><br>Press any key to start.</p>"
    };

    // ----- Demo 1: Base plugin with explicit targets[] and distractors[] -----
    const trial_rsvp_explicit = {
      type: jsPsychRsvp,                  // or "rsvp"
      // short-form streams — left, right
      streams: [
        ["O","O","Q","O","O","O"],
        ["O","O","O","O","O","O"],
      ],
      stimulus_duration: 200,
      isi: 40,
      choices: ["f","j"],

      // target on the left at index 2 (circle)
      decorate_targets: true,
      target_shape: "none",               // let the per-target set it
      targets: [
        { stream_id: "left", index: 2, shape: "circle" },
      ],

      // distractor on the right at the same frame (square)
      decorate_distractors: true,
      distractor_shape: "underline",      // default if per-distractor omits shape
      distractor_color: "#888",
      distractor_stroke: "2px",
      distractors: [
        { stream_id: "right", index: 2, shape: "square" },
      ],
    };

    // ----- Demo 2: Simpler bilateral API with distractor_index / distractor_shape -----
    const trial_bilateral_simple = {
      type: jsPsychBilateralRsvp,         // or "rsvp-bilateral"
      left:  ["O","O","O","O","Q","O"],
      right: ["O","O","Q","O","O","O"],
      target_side: "right",
      target_index: 4,
      target_shape: "square",
      distractor_shape: "circle",
      stimulus_duration: 200,
      isi: 40,
      choices: ["f","j"],
    };

    jsPsych.run([welcome, trial_rsvp_explicit, trial_bilateral_simple]);
  </script>

  <div class="note">
    Demo 1: base plugin with <code>targets[]</code> and <code>distractors[]</code> ·
    Demo 2: bilateral wrapper with <code>distractor_index</code> &amp; <code>distractor_shape</code>.
  </div>
</body>
</html>
